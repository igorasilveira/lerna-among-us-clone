{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/igorsilveira/Documents/Projects/lerna-among-us-clone/packages/app/components/Canvas.tsx\";\nimport React, { useEffect, useState } from 'react';\nimport dynamic from 'next/dynamic';\nimport Joystick from '../classes/Joystick';\nimport useGameMap from '../hooks/useGameMap';\nimport useGamePlayer from '../hooks/useGamePlayer';\nimport useGameTask from '../hooks/useGameTask';\nimport useGameAction from '../hooks/useGameAction';\nimport { useGameState } from '../context/GameContext';\nconst Sketch = dynamic(() => import('react-p5'), {\n  ssr: false,\n  loadableGenerated: {\n    webpack: () => [require.resolveWeak('react-p5')],\n    modules: ['react-p5']\n  }\n});\nlet joystick;\nexport default function Canvas() {\n  const {\n    setupMap,\n    renderMap,\n    updateMap\n  } = useGameMap();\n  const {\n    setupActions,\n    preloadActions,\n    renderActions,\n    updateActions,\n    clickedActions\n  } = useGameAction();\n  const {\n    setupTasks,\n    renderTasks,\n    updateTasks\n  } = useGameTask();\n  const {\n    setupPlayer,\n    renderPlayer,\n    updatePlayer\n  } = useGamePlayer();\n  const {\n    currentOverlay\n  } = useGameState();\n  const {\n    0: ready,\n    1: setReady\n  } = useState(false);\n  useEffect(() => {\n    setReady(true);\n  }, []);\n\n  const setup = (p5, canvasParentRef) => {\n    p5.createCanvas(700, 400).parent(canvasParentRef);\n    setupActions();\n    joystick = new Joystick(100, p5.height - 100, 100, p5);\n  };\n\n  const draw = p5 => {\n    p5.background(0);\n    const speed = joystick.update();\n    updatePlayer(speed);\n    updateTasks();\n    updateActions();\n    updateMap();\n    renderMap();\n    renderTasks();\n    renderPlayer();\n    renderActions();\n    joystick.render();\n  };\n\n  const preload = p5 => {\n    setupMap(p5);\n    setupPlayer(p5);\n    setupTasks(p5);\n    preloadActions(p5);\n  };\n\n  const touchStarted = () => {\n    if (currentOverlay) {\n      return;\n    }\n\n    joystick.activateJoystick(true);\n  };\n\n  const touchEnded = () => {\n    joystick.activateJoystick(false);\n  };\n\n  const mouseClicked = () => {\n    if (currentOverlay) {\n      return;\n    }\n\n    clickedActions();\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [!ready && /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 18\n    }, this), ready && /*#__PURE__*/_jsxDEV(Sketch, {\n      setup: setup,\n      draw: draw,\n      preload: preload,\n      touchStarted: touchStarted,\n      touchEnded: touchEnded,\n      mouseClicked: mouseClicked\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n}","map":{"version":3,"sources":["/Users/igorsilveira/Documents/Projects/lerna-among-us-clone/packages/app/components/Canvas.tsx"],"names":["React","useEffect","useState","dynamic","Joystick","useGameMap","useGamePlayer","useGameTask","useGameAction","useGameState","Sketch","ssr","joystick","Canvas","setupMap","renderMap","updateMap","setupActions","preloadActions","renderActions","updateActions","clickedActions","setupTasks","renderTasks","updateTasks","setupPlayer","renderPlayer","updatePlayer","currentOverlay","ready","setReady","setup","p5","canvasParentRef","createCanvas","parent","height","draw","background","speed","update","render","preload","touchStarted","activateJoystick","touchEnded","mouseClicked"],"mappings":";;;AAAA,OAAOA,KAAP,IAAeC,SAAf,EAA0BC,QAA1B,QAAyC,OAAzC;AAEA,OAAOC,OAAP,MAAoB,cAApB;AAEA,OAAOC,QAAP,MAAqB,qBAArB;AACA,OAAOC,UAAP,MAAuB,qBAAvB;AACA,OAAOC,aAAP,MAA0B,wBAA1B;AACA,OAAOC,WAAP,MAAwB,sBAAxB;AACA,OAAOC,aAAP,MAA0B,wBAA1B;AACA,SAAQC,YAAR,QAA2B,wBAA3B;AAEA,MAAMC,MAAM,GAAGP,OAAO,CACpB,MAAM,OAAO,UAAP,CADc,EAEpB;AAACQ,EAAAA,GAAG,EAAE,KAAN;AAAA;AAAA,wCADa,UACb;AAAA,cADa,UACb;AAAA;AAAA,CAFoB,CAAtB;AAKA,IAAIC,QAAJ;AAEA,eAAe,SAASC,MAAT,GAAkB;AAC/B,QAAM;AAACC,IAAAA,QAAD;AAAWC,IAAAA,SAAX;AAAsBC,IAAAA;AAAtB,MAAmCX,UAAU,EAAnD;AACA,QAAM;AAACY,IAAAA,YAAD;AAAeC,IAAAA,cAAf;AAA+BC,IAAAA,aAA/B;AAA8CC,IAAAA,aAA9C;AAA6DC,IAAAA;AAA7D,MAA+Eb,aAAa,EAAlG;AACA,QAAM;AAACc,IAAAA,UAAD;AAAaC,IAAAA,WAAb;AAA0BC,IAAAA;AAA1B,MAAyCjB,WAAW,EAA1D;AACA,QAAM;AAACkB,IAAAA,WAAD;AAAcC,IAAAA,YAAd;AAA4BC,IAAAA;AAA5B,MAA4CrB,aAAa,EAA/D;AACA,QAAM;AAACsB,IAAAA;AAAD,MAAmBnB,YAAY,EAArC;AAEA,QAAM;AAAA,OAACoB,KAAD;AAAA,OAAQC;AAAR,MAAoB5B,QAAQ,CAAC,KAAD,CAAlC;AAEAD,EAAAA,SAAS,CAAC,MAAM;AACd6B,IAAAA,QAAQ,CAAC,IAAD,CAAR;AACD,GAFQ,EAEN,EAFM,CAAT;;AAIA,QAAMC,KAAK,GAAG,CAACC,EAAD,EAAcC,eAAd,KAA2C;AACvDD,IAAAA,EAAE,CAACE,YAAH,CAAgB,GAAhB,EAAqB,GAArB,EAA0BC,MAA1B,CAAiCF,eAAjC;AACAhB,IAAAA,YAAY;AACZL,IAAAA,QAAQ,GAAG,IAAIR,QAAJ,CAAa,GAAb,EAAkB4B,EAAE,CAACI,MAAH,GAAY,GAA9B,EAAmC,GAAnC,EAAwCJ,EAAxC,CAAX;AACD,GAJD;;AAMA,QAAMK,IAAI,GAAIL,EAAD,IAAiB;AAC5BA,IAAAA,EAAE,CAACM,UAAH,CAAc,CAAd;AACA,UAAMC,KAAK,GAAG3B,QAAQ,CAAC4B,MAAT,EAAd;AACAb,IAAAA,YAAY,CAACY,KAAD,CAAZ;AACAf,IAAAA,WAAW;AACXJ,IAAAA,aAAa;AACbJ,IAAAA,SAAS;AACTD,IAAAA,SAAS;AACTQ,IAAAA,WAAW;AACXG,IAAAA,YAAY;AACZP,IAAAA,aAAa;AACbP,IAAAA,QAAQ,CAAC6B,MAAT;AACD,GAZD;;AAcA,QAAMC,OAAO,GAAIV,EAAD,IAAiB;AAC/BlB,IAAAA,QAAQ,CAACkB,EAAD,CAAR;AACAP,IAAAA,WAAW,CAACO,EAAD,CAAX;AACAV,IAAAA,UAAU,CAACU,EAAD,CAAV;AACAd,IAAAA,cAAc,CAACc,EAAD,CAAd;AACD,GALD;;AAOA,QAAMW,YAAY,GAAG,MAAM;AACzB,QAAIf,cAAJ,EAAoB;AAAE;AAAS;;AAC/BhB,IAAAA,QAAQ,CAACgC,gBAAT,CAA0B,IAA1B;AACD,GAHD;;AAKA,QAAMC,UAAU,GAAG,MAAM;AACvBjC,IAAAA,QAAQ,CAACgC,gBAAT,CAA0B,KAA1B;AACD,GAFD;;AAIA,QAAME,YAAY,GAAG,MAAM;AACzB,QAAIlB,cAAJ,EAAoB;AAAE;AAAS;;AAC/BP,IAAAA,cAAc;AACf,GAHD;;AAKA,sBACE;AAAA,eACG,CAACQ,KAAD,iBAAU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YADb,EAEGA,KAAK,iBACJ,QAAC,MAAD;AACE,MAAA,KAAK,EAAEE,KADT;AAEE,MAAA,IAAI,EAAEM,IAFR;AAGE,MAAA,OAAO,EAAEK,OAHX;AAIE,MAAA,YAAY,EAAEC,YAJhB;AAKE,MAAA,UAAU,EAAEE,UALd;AAME,MAAA,YAAY,EAAEC;AANhB;AAAA;AAAA;AAAA;AAAA,YAHJ;AAAA,kBADF;AAcD","sourcesContent":["import React, {useEffect, useState} from 'react';\nimport * as p5Types from 'p5';\nimport dynamic from 'next/dynamic';\n\nimport Joystick from '../classes/Joystick';\nimport useGameMap from '../hooks/useGameMap';\nimport useGamePlayer from '../hooks/useGamePlayer';\nimport useGameTask from '../hooks/useGameTask';\nimport useGameAction from '../hooks/useGameAction';\nimport {useGameState} from '../context/GameContext';\n\nconst Sketch = dynamic(\n  () => import('react-p5'),\n  {ssr: false},\n);\n\nlet joystick: Joystick;\n\nexport default function Canvas() {\n  const {setupMap, renderMap, updateMap} = useGameMap();\n  const {setupActions, preloadActions, renderActions, updateActions, clickedActions} = useGameAction();\n  const {setupTasks, renderTasks, updateTasks} = useGameTask();\n  const {setupPlayer, renderPlayer, updatePlayer} = useGamePlayer();\n  const {currentOverlay} = useGameState();\n\n  const [ready, setReady] = useState(false);\n\n  useEffect(() => {\n    setReady(true);\n  }, []);\n\n  const setup = (p5: p5Types, canvasParentRef: Element) => {\n    p5.createCanvas(700, 400).parent(canvasParentRef);\n    setupActions();\n    joystick = new Joystick(100, p5.height - 100, 100, p5);\n  };\n\n  const draw = (p5: p5Types) => {\n    p5.background(0);\n    const speed = joystick.update();\n    updatePlayer(speed);\n    updateTasks();\n    updateActions();\n    updateMap();\n    renderMap();\n    renderTasks();\n    renderPlayer();\n    renderActions();\n    joystick.render();\n  };\n\n  const preload = (p5: p5Types) => {\n    setupMap(p5);\n    setupPlayer(p5);\n    setupTasks(p5);\n    preloadActions(p5);\n  };\n\n  const touchStarted = () => {\n    if (currentOverlay) { return; }\n    joystick.activateJoystick(true);\n  };\n\n  const touchEnded = () => {\n    joystick.activateJoystick(false);\n  };\n\n  const mouseClicked = () => {\n    if (currentOverlay) { return; }\n    clickedActions();\n  };\n\n  return (\n    <>\n      {!ready && <p>Loading...</p>}\n      {ready &&\n        <Sketch\n          setup={setup}\n          draw={draw}\n          preload={preload}\n          touchStarted={touchStarted}\n          touchEnded={touchEnded}\n          mouseClicked={mouseClicked}\n        />}\n    </>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}